%table
  %thead
    %tr
      %th.handle{:colspan => 2}
        = human_model_name(model)
        - if model != query_generator_session.query.constantized_main_model
          = link_to_remote(image_tag("query_generator/red-x.png"), :url => remove_model_query_generator_generated_queries_path(:model => model.to_s),
                                                                   :confirm => t("query_generator.wizard.associations.remove_model_warning"),
                                                                   :html => {:title => t("query_generator.wizard.associations.remove_model_title")})

  %tbody
    - dh.graph.associations_for(model).each do |association, target|
      - next unless ccan? :read, target
      - next if target.to_s == query_generator_session.generated_query.main_model
      - next if query_generator_session.query.association_targets.include?(target.to_s)
      - next if query_generator_session.query.associations_for(target).values.include?(model.to_s)
      = render :partial => wizard_file(2, "association_row"), :locals => {:model => model, :association => association, :end_point => target}